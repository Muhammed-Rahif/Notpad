var _={dragStart:!0},tt={delay:0,distance:3},ct=(e,l,a)=>Math.min(Math.max(e,l),a),et=e=>typeof e=="string",yt=([e,l],a,c)=>{const u=(y,h)=>h===0?0:Math.ceil(y/h)*h;return[u(a,e),u(c,l)]},ut=(e,l)=>e.some(a=>l.some(c=>a.contains(c)));function rt(e,l){if(e===void 0)return;if(nt(e))return e.getBoundingClientRect();if(typeof e=="object"){const{top:c=0,left:u=0,right:y=0,bottom:h=0}=e;return{top:c,right:window.innerWidth-y,bottom:window.innerHeight-h,left:u}}if(e==="parent")return l.parentNode.getBoundingClientRect();const a=document.querySelector(e);if(a===null)throw new Error("The selector provided for bound doesn't exists in the document.");return a.getBoundingClientRect()}var k=(e,l,a)=>e.style.setProperty(l,a),nt=e=>e instanceof HTMLElement,wt=function(e,l={}){let a,c,{bounds:u,axis:y="both",gpuAcceleration:h=!0,legacyTranslate:ot=!1,transform:L,applyUserSelectHack:z=!0,disabled:at=!1,ignoreMultitouch:I=!1,recomputeBounds:x=_,grid:U,threshold:E=tt,position:p,cancel:R,handle:$,defaultClass:X="neodrag",defaultClassDragging:W="neodrag-dragging",defaultClassDragged:N="neodrag-dragged",defaultPosition:ft={x:0,y:0},onDragStart:gt,onDrag:ht,onDragEnd:pt}=l,A=!1,S=!1,it=0,M=!1,Y=!1,w=0,b=0,C=0,D=0,j=0,F=0,{x:q,y:H}=p?{x:(p==null?void 0:p.x)??0,y:(p==null?void 0:p.y)??0}:ft;O(q,H);let f,v,B,G,J,st="",mt=!!p;x={..._,...x},E={...tt,...E??{}};let P=new Set;function lt(){A&&!S&&Y&&M&&J&&(S=!0,Q("neodrag:start",gt),m.add(W),z&&(st=K.userSelect,K.userSelect="none"))}const K=document.body.style,m=e.classList;function O(t=w,n=b){if(!L){if(ot){let i=`${+t}px, ${+n}px`;return k(e,"transform",h?`translate3d(${i}, 0)`:`translate(${i})`)}return k(e,"translate",`${+t}px ${+n}px`)}const o=L({offsetX:t,offsetY:n,rootNode:e});et(o)&&k(e,"transform",o)}function Q(t,n){const o={offsetX:w,offsetY:b,rootNode:e,currentNode:J};e.dispatchEvent(new CustomEvent(t,{detail:o})),n==null||n(o)}const T=addEventListener,V=new AbortController,Z={signal:V.signal,capture:!1};function dt(){let t=e.offsetWidth/v.width;return isNaN(t)&&(t=1),t}return k(e,"touch-action","none"),T("pointerdown",t=>{if(at||t.button===2)return;if(P.add(t.pointerId),I&&P.size>1)return t.preventDefault();if(x.dragStart&&(f=rt(u,e)),et($)&&et(R)&&$===R)throw new Error("`handle` selector can't be same as `cancel` selector");if(m.add(X),B=function(r,d){if(!r)return[d];if(nt(r))return[r];if(Array.isArray(r))return r;const g=d.querySelectorAll(r);if(g===null)throw new Error("Selector passed for `handle` option should be child of the element on which the action is applied");return Array.from(g.values())}($,e),G=function(r,d){if(!r)return[];if(nt(r))return[r];if(Array.isArray(r))return r;const g=d.querySelectorAll(r);if(g===null)throw new Error("Selector passed for `cancel` option should be child of the element on which the action is applied");return Array.from(g.values())}(R,e),a=/(both|x)/.test(y),c=/(both|y)/.test(y),ut(G,B))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");const n=t.composedPath()[0];if(!B.some(r=>{var d;return r.contains(n)||((d=r.shadowRoot)==null?void 0:d.contains(n))})||ut(G,[n]))return;J=B.length===1?e:B.find(r=>r.contains(n)),A=!0,it=Date.now(),E.delay||(M=!0),v=e.getBoundingClientRect();const{clientX:o,clientY:i}=t,s=dt();a&&(C=o-q/s),c&&(D=i-H/s),f&&(j=o-v.left,F=i-v.top)},Z),T("pointermove",t=>{if(!A||I&&P.size>1)return;if(!S){if(M||Date.now()-it>=E.delay&&(M=!0,lt()),!Y){const s=t.clientX-C,r=t.clientY-D;Math.sqrt(s**2+r**2)>=E.distance&&(Y=!0,lt())}if(!S)return}x.drag&&(f=rt(u,e)),t.preventDefault(),v=e.getBoundingClientRect();let n=t.clientX,o=t.clientY;const i=dt();if(f){const s={left:f.left+j,top:f.top+F,right:f.right+j-v.width,bottom:f.bottom+F-v.height};n=ct(n,s.left,s.right),o=ct(o,s.top,s.bottom)}if(Array.isArray(U)){let[s,r]=U;if(isNaN(+s)||s<0)throw new Error("1st argument of `grid` must be a valid positive number");if(isNaN(+r)||r<0)throw new Error("2nd argument of `grid` must be a valid positive number");let d=n-C,g=o-D;[d,g]=yt([s/i,r/i],d,g),n=C+d,o=D+g}a&&(w=Math.round((n-C)*i)),c&&(b=Math.round((o-D)*i)),q=w,H=b,Q("neodrag",ht),O()},Z),T("pointerup",t=>{P.delete(t.pointerId),A&&(S&&(T("click",n=>n.stopPropagation(),{once:!0,signal:V.signal,capture:!0}),x.dragEnd&&(f=rt(u,e)),m.remove(W),m.add(N),z&&(K.userSelect=st),Q("neodrag:end",pt),a&&(C=w),c&&(D=b)),A=!1,S=!1,M=!1,Y=!1)},Z),{destroy:()=>V.abort(),update:t=>{var o,i;y=t.axis||"both",at=t.disabled??!1,I=t.ignoreMultitouch??!1,$=t.handle,u=t.bounds,x=t.recomputeBounds??_,R=t.cancel,z=t.applyUserSelectHack??!0,U=t.grid,h=t.gpuAcceleration??!0,ot=t.legacyTranslate??!0,L=t.transform,E={...tt,...t.threshold??{}};const n=m.contains(N);m.remove(X,N),X=t.defaultClass??"neodrag",W=t.defaultClassDragging??"neodrag-dragging",N=t.defaultClassDragged??"neodrag-dragged",m.add(X),n&&m.add(N),mt&&(q=w=((o=t.position)==null?void 0:o.x)??w,H=b=((i=t.position)==null?void 0:i.y)??b,O())}}};export{wt as d};
